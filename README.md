## 全功能智能小车
#### 1. 架构
核心版芯片：CC2530

组件：

    直流电机组件： 直流电机
    
    蓝牙组件： UART蓝牙模组占用UART2个复用IO引脚
    
    红外感应组件： 红外接收器件占用一个IO引脚，作为接收端使用，ENC协议解码功能自实现。
    
    EHC超声波组件：超声波器件占用2个IO引脚，RX作为接收端使用，TX作为发送端使用。发送到接收的距离自实现。

上位机：Linux A7平板

手机APP: 蓝牙信令发送APP

#### 2. 直流电机组件 -- CommonFunction

a. 电机转速控制：配置晶振的定时器，模拟PWM占空比, 对电机速率进行驱动控制

b. 转速调节：弹片式按键进行模式切换，模式决定转速速率。蜂鸣器报警提示模式切换

c. IO驱动: 芯片IO驱动电机芯片，电机芯片接通电池，高压驱动电机。

#### 3. 蓝牙组件  -- BluetoothCar

a. UART串口接收： 蓝牙模组与核心版芯片通过UART连接，蓝牙模组接收到蓝牙信令后，转换成UART数据发送到控制芯片。
所以芯片程序只需要配置UART口，UART中断中接收数据后处理即可

b. 晶码管显示: 晶码管只需要芯片IO驱动灯，不涉及LCD屏，TFTP屏协议驱动显示

#### 4. 红外感应组件  -- InfraredControlTrolley

a. 红外信号接收：一个IO口连接红外器件，红外器件将接收到的红外信息模拟信号转换成数字信号，输送到芯片IO口。芯片IO接收到
信号中断开始存入数据，红外脉宽34存入34次作为一帧数据。循环采集红外脉宽的数字信号

b. ENC协议解码：33位红外帧数据，丢弃引导码可以解析成4字节数据

#### 5. EHC超声波组件    -- UltrasonicWallBarrier

a. 超声接收发送： 一个IO口连接HC_SR04传感器的RX回响端, 一个IO口连接TX触发端. TX触发HC_SR04器件发送超声波，T1定时器开
启，开始计数。RX接收超声波后触发关闭T1定时器，计数*频率*声波速度/2 = 距离

b. 超声波避障：超声传感器计算前方物体的距离后，判断距离阈值是否需要使用电机组件，进行转向功能。 其中正常前进计算距离频率
为60hz, 检测到物体转向中关闭超声模块，后面继续前进避障。

#### 6. 上位机

使用A7芯片平板作为中控，使用UART串口作为上位机与车机的通讯模块. 

#### 7. 蓝牙APP
车机上的蓝牙器件与手机蓝牙APP连接，目前车机只做接收使用，手机APP只发送蓝牙控制信令到车机
